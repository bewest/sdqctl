# proposal-development.conv - Synthesis cycle for sdqctl proposal work
#
# A long-lived workflow for iteratively developing sdqctl proposals,
# resolving design decisions, and implementing features.
#
# Usage:
#   cd /path/to/sdqctl
#   sdqctl cycle examples/workflows/proposal-development.conv --adapter copilot
#
# This workflow:
# 1. Loads current backlog and feature interactions
# 2. Selects highest-priority open question or task
# 3. Works through the item (analysis, design, or implementation)
# 4. Updates tracking documents
# 5. Commits progress and queues next work
#
# State relay: BACKLOG.md and FEATURE-INTERACTIONS.md persist across cycles

MODEL claude-sonnet-4-20250514
ADAPTER copilot
MODE implement
MAX-CYCLES 3

# === Session Context ===
PROLOGUE ---
PROLOGUE ## sdqctl Proposal Development Session
PROLOGUE Branch: {{GIT_BRANCH}} ({{GIT_COMMIT}})
PROLOGUE Date: {{DATETIME}}
PROLOGUE ---

EPILOGUE ---
EPILOGUE Remember:
EPILOGUE - Update BACKLOG.md checkboxes as tasks complete
EPILOGUE - Mark decisions in FEATURE-INTERACTIONS.md when resolved
EPILOGUE - Commit after each meaningful change
EPILOGUE - Keep proposals internally consistent

# === Load Tracking State ===
# These files persist state across cycles (state relay pattern)
@proposals/BACKLOG.md
@docs/FEATURE-INTERACTIONS.md

# === Load Active Proposals ===
@proposals/RUN-BRANCHING.md
@proposals/VERIFICATION-DIRECTIVES.md
@proposals/PIPELINE-ARCHITECTURE.md
@proposals/STPA-INTEGRATION.md

# === Supporting Documentation ===
@docs/GLOSSARY.md
@docs/SYNTHESIS-CYCLES.md

# === Cycle 1: Assess and Select ===
PROMPT ## Work Selection

Review the BACKLOG.md and FEATURE-INTERACTIONS.md to understand current state.

**Identify the highest-priority actionable item:**

1. **Priority 1 - Blocking Design Decisions** (ðŸ”¶ in interaction matrix)
   - These block implementation work
   - Examples: ELIDE+RUN-BRANCH, COMPACT+VERIFY, RUN-BRANCH+CHECKPOINT

2. **Priority 2 - Implementation Tasks** (ðŸŸ¡ in backlog)
   - Features designed but not implemented
   - Examples: --from-json, VERIFY directives, STPA templates

3. **Priority 3 - New Proposals** (ideas in backlog)
   - Future capability proposals
   - Only if P1/P2 are clear

**Output format:**
```markdown
### Selected Item
**Type:** Design Decision | Implementation | Proposal
**ID/Name:** [From backlog or interaction matrix]
**Current State:** [What exists now]
**Goal:** [What we're trying to achieve]
**Approach:** [How we'll tackle it this session]
**Artifacts to update:** [Which files will change]
```

# === Cycle 2: Work the Item ===
PROMPT ## Execute Work

Based on your selected item, do the work now.

**For Design Decisions:**
1. State the question clearly
2. Enumerate options with trade-offs
3. Make a recommendation with rationale
4. Update FEATURE-INTERACTIONS.md with the decision
5. Update any affected proposals

**For Implementation Tasks:**
1. Write or update the code/templates
2. Test that it works (if applicable)
3. Update documentation to match
4. Update BACKLOG.md to mark progress

**For New Proposals:**
1. Create new proposal file in proposals/
2. Follow existing proposal structure
3. Add to BACKLOG.md tracking
4. Cross-reference from related proposals

**Do the actual work - edit files, don't just describe.**

# === Cycle 3: Commit and Queue ===
PROMPT ## Document Progress

**Section 1: Work Completed**
- What was decided/implemented
- Files modified
- Key insights or trade-offs

**Section 2: Tracking Updates**
Update these documents NOW:
- BACKLOG.md: Check off completed items, add new items discovered
- FEATURE-INTERACTIONS.md: Mark resolved decisions (ðŸ”¶ â†’ âœ…)

**Section 3: Commit**
Stage and commit all changes with a descriptive message.

**Section 4: Next Session**
Identify the next 2-3 items to work on and why.

Provide exact command for next session:
```bash
sdqctl cycle examples/workflows/proposal-development.conv --adapter copilot
```

# === Output Configuration ===
HEADER # Proposal Development Session
HEADER ## {{DATETIME}}
HEADER **Branch:** {{GIT_BRANCH}} | **Commit:** {{GIT_COMMIT}}
HEADER ---

FOOTER ---
FOOTER ## Session Meta
FOOTER Generated by `proposal-development.conv` - a synthesis cycle for
FOOTER iterative proposal development.
FOOTER
FOOTER State persists in:
FOOTER - `proposals/BACKLOG.md` - Task tracking
FOOTER - `docs/FEATURE-INTERACTIONS.md` - Design decisions
FOOTER
FOOTER Continue with:
FOOTER ```bash
FOOTER sdqctl cycle examples/workflows/proposal-development.conv --adapter copilot
FOOTER ```

OUTPUT-FORMAT markdown
OUTPUT-FILE reports/proposal-session-{{DATE}}.md

# === Checkpointing ===
CHECKPOINT-AFTER 1
CHECKPOINT-NAME proposal-select

CHECKPOINT-AFTER 2
CHECKPOINT-NAME proposal-work

CHECKPOINT-AFTER 3
CHECKPOINT-NAME proposal-commit

PROMPT Save all appropriate changes to git.
COMPACT
